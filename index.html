<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ID_IDOSR_Bouarfa - Espace Num√©rique</title>
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/style.css?v=2">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <!-- Background Elements -->
    <div class="circle circle-1"></div>
    <div class="circle circle-2"></div>

    <div class="container">
        <!-- Page de connexion -->
        <div id="loginPage" class="login-container glass">
            <div class="logo">
                <h1>üìö ID_IDOSR_Bouarfa</h1>
                <p>Infrastructure Digitale - ISTA Bouarfa</p>
            </div>
            <div class="form-group">
                <label><i class="fas fa-user"></i> Identifiant / CIN</label>
                <input type="text" id="username" placeholder="Entrez votre identifiant">
            </div>
            <div class="form-group">
                <label for="password">Mot de passe</label>
                <div class="password-wrapper">
                    <input type="password" id="password" placeholder="Entrez votre mot de passe">
                    <i class="fas fa-eye password-toggle" id="togglePasswordBtn"
                        onclick="togglePasswordVisibility()"></i>
                </div>
            </div>
            <button class="btn" onclick="login()">Se connecter <i class="fas fa-arrow-right"></i></button>
            <div id="loginError"
                style="color: #ff4b4b; margin-top: 15px; text-align: center; display: none; font-size: 0.9rem;"></div>
        </div>

        <!-- Dashboard Formateur -->
        <div id="formateurDashboard" class="dashboard glass">
            <div class="dashboard-layout">
                <!-- Sidebar -->
                <aside class="sidebar">
                    <div class="sidebar-header">
                        <h2><i class="fas fa-layer-group"></i></h2>
                    </div>

                    <div class="user-info">
                        <div class="user-avatar"><i class="fas fa-chalkboard-teacher"></i></div>
                        <div class="user-details">
                            <p>Formateur</p>
                        </div>
                    </div>

                    <nav class="nav-links">
                        <button class="nav-item active" onclick="switchTab('vue-ensemble')">
                            <i class="fas fa-home"></i> <span>Vue d'ensemble</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('stagiaires')">
                            <i class="fas fa-users"></i> <span>Stagiaires</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('modules')">
                            <i class="fas fa-book"></i> <span>Modules & Notes</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('absences')">
                            <i class="fas fa-user-clock"></i> <span>Absences</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('cours')">
                            <i class="fas fa-file-pdf"></i> <span>Cours</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('examens')">
                            <i class="fas fa-file-alt"></i> <span>Sujets des examens</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('dates-examens')">
                            <i class="fas fa-calendar-alt"></i> <span>Dates des examens</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('vacances')">
                            <i class="fas fa-umbrella-beach"></i> <span>Vacances</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('statistiques')">
                            <i class="fas fa-chart-bar"></i> <span>Statistiques</span>
                        </button>
                        <button class="nav-item" onclick="switchTab('parametres')">
                            <i class="fas fa-cog"></i> <span>Param√®tres</span>
                        </button>
                    </nav>

                    <div class="nav-actions">
                        <button class="btn-logout" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> <span>D√©connexion</span>
                        </button>
                    </div>
                </aside>

                <!-- Mobile Header (Visible on mobile only) -->
                <div class="mobile-header lg-hidden"> <!-- Added via CSS Media rule Logic -->
                </div>

                <!-- Main Content -->
                <main class="main-content">

                    <!-- Vue d'ensemble -->
                    <div id="vue-ensemble" class="tab-content active">
                        <div class="page-header">
                            <h2>Tableau de bord</h2>
                        </div>
                        <div class="grid">
                            <div class="glass info-card">
                                <h4>Total Stagiaires</h4>
                                <p id="totalStagiaires">0</p>
                                <i class="fas fa-users"
                                    style="position: absolute; top: 20px; right: 20px; color: rgba(255,255,255,0.2); font-size: 1.5rem;"></i>
                            </div>
                            <div class="glass info-card">
                                <h4>Total Modules</h4>
                                <p id="totalModules">0</p>
                                <i class="fas fa-book"
                                    style="position: absolute; top: 20px; right: 20px; color: rgba(255,255,255,0.2); font-size: 1.5rem;"></i>
                            </div>
                            <div class="glass info-card">
                                <h4>Cours Disponibles</h4>
                                <p id="totalCours">0</p>
                                <i class="fas fa-file-pdf"
                                    style="position: absolute; top: 20px; right: 20px; color: rgba(255,255,255,0.2); font-size: 1.5rem;"></i>
                            </div>
                            <div class="glass info-card">
                                <h4>Sujets d'examen</h4>
                                <p id="totalExamens">0</p>
                                <i class="fas fa-file-alt"
                                    style="position: absolute; top: 20px; right: 20px; color: rgba(255,255,255,0.2); font-size: 1.5rem;"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Stagiaires -->
                    <div id="stagiaires" class="tab-content">
                        <div class="page-header">
                            <h2>Gestion Stagiaires</h2>
                        </div>
                        <div class="glass content-card">
                            <h3><i class="fas fa-file-import"></i> Importer</h3>
                            <div class="grid" style="grid-template-columns: 1fr 2fr auto;">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="importAnnee">
                                        <option value="1A">1√®re Ann√©e (1A)</option>
                                        <option value="2A">2√®me Ann√©e (2A)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Fichier Excel (.xlsx)</label>
                                    <input type="file" id="excelFile" accept=".xlsx,.xls,.csv">
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn" onclick="importStagiaires()">Importer</button>
                                </div>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 0.8rem;">Columns: CIN, Nom, Pr√©nom.
                                Default Password: CIN@HijriYear</p>
                        </div>

                        <div class="glass content-card">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3>Liste des Stagiaires</h3>
                                <div class="form-group" style="margin: 0; width: 200px;">
                                    <select id="filterAnnee" onchange="afficherStagiaires()">
                                        <option value="">Toutes les ann√©es</option>
                                        <option value="1A">1√®re Ann√©e (1A)</option>
                                        <option value="2A">2√®me Ann√©e (2A)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table id="stagiairesList">
                                    <thead>
                                        <tr>
                                            <th>CIN</th>
                                            <th>Nom</th>
                                            <th>Pr√©nom</th>
                                            <th>Ann√©e</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Modules & Notes -->
                    <div id="modules" class="tab-content">
                        <div class="page-header">
                            <h2>Modules & Notes</h2>
                        </div>
                        <div class="glass content-card">
                            <h3>Nouveau Module</h3>
                            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="moduleAnnee">
                                        <option value="1A">1√®re Ann√©e (1A)</option>
                                        <option value="2A">2√®me Ann√©e (2A)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Nom</label>
                                    <input type="text" id="moduleName" placeholder="Ex: R√©seaux">
                                </div>
                                <div class="form-group">
                                    <label>Type</label>
                                    <select id="moduleType">
                                        <option value="Local">Local</option>
                                        <option value="R√©gional">R√©gional</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Coef.</label>
                                    <input type="number" id="moduleCoefficient" value="1" min="1" max="10" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label>Contr√¥les</label>
                                    <select id="nbControles">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn" onclick="ajouterModule()"><i class="fas fa-plus"></i>
                                        Ajouter</button>
                                </div>
                            </div>
                        </div>

                        <div class="glass content-card">
                            <h3>Saisie des notes</h3>
                            <div class="grid" style="grid-template-columns: 1fr 1fr;">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="notesAnnee" onchange="chargerModulesParAnnee()">
                                        <option value="">-- Choisir une ann√©e --</option>
                                        <option value="1A">1√®re Ann√©e (1A)</option>
                                        <option value="2A">2√®me Ann√©e (2A)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Module</label>
                                    <select id="moduleSelect" onchange="chargerNotesModule()">
                                        <option value="">-- D'abord choisir une ann√©e --</option>
                                    </select>
                                </div>
                            </div>
                            <div id="notesSection"></div>
                        </div>
                    </div>

                    <!-- Absences -->
                    <div id="absences" class="tab-content">
                        <div class="page-header">
                            <h2>Gestion des Absences</h2>
                        </div>
                        <div class="glass content-card">
                            <h3>Nouvelle Absence</h3>
                            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="absenceAnnee" onchange="chargerStagiairesParAnnee()">
                                        <option value="">-- Choisir --</option>
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Stagiaire</label>
                                    <select id="absenceStagiaire"></select>
                                </div>
                                <div class="form-group">
                                    <label>Date</label>
                                    <input type="date" id="absenceDate">
                                </div>
                                <div class="form-group">
                                    <label>Horaire</label>
                                    <select id="absenceHoraire">
                                        <option value="8h30-11h">8h30 ‚Üí 11h</option>
                                        <option value="11h-13h30">11h ‚Üí 13h30</option>
                                        <option value="13h30-16h">13h30 ‚Üí 16h</option>
                                        <option value="16h-18h30">16h ‚Üí 18h30</option>
                                    </select>
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn" onclick="ajouterAbsence()">Enregistrer</button>
                                </div>
                            </div>
                        </div>

                        <div class="glass content-card">
                            <div style="display: flex; justify-content: space-between;">
                                <h3>Historique</h3>
                                <div class="form-group" style="margin:0; width: 150px;">
                                    <select id="filterAbsenceAnnee" onchange="afficherAbsences()">
                                        <option value="">Tout</option>
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table id="absencesTable">
                                    <thead>
                                        <tr>
                                            <th>Stagiaire</th>
                                            <th>Ann√©e</th>
                                            <th>Total</th>
                                            <th>D√©tails</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Cours -->
                    <div id="cours" class="tab-content">
                        <div class="page-header">
                            <h2>Gestion des Cours</h2>
                        </div>
                        <div class="glass content-card">
                            <h3>Publier un cours</h3>
                            <div class="grid">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="coursAnnee" onchange="chargerModulesPublication()">
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Titre</label>
                                    <input type="text" id="coursTitle">
                                </div>
                                <div class="form-group">
                                    <label>Module (ID)</label>
                                    <select id="coursModule">
                                        <!-- Need logic to populate this or just input text if simplified -->
                                        <!-- For now, re-using chargerModules functionality might be needed, 
                                             but let's assume we load all modules on init for simplified usage -->
                                    </select>
                                    <!-- Temporary fix: script to populate this on load -->
                                </div>
                                <div class="form-group">
                                    <label>Fichier</label>
                                    <input type="file" id="coursFile" accept=".pdf,.doc,.docx,.ppt,.pptx,.txt">
                                </div>
                            </div>
                            <button class="btn" onclick="ajouterCours()">Publier</button>
                        </div>
                        <div class="glass content-card">
                            <h3>Cours Publi√©s</h3>
                            <select id="filterCoursAnnee" onchange="afficherCours()" style="margin-bottom: 20px;">
                                <option value="">Tous</option>
                                <option value="1A">1A</option>
                                <option value="2A">2A</option>
                            </select>
                            <div class="table-responsive">
                                <table id="coursList">
                                    <thead>
                                        <tr>
                                            <th>Titre</th>
                                            <th>Module</th>
                                            <th>Ann√©e</th>
                                            <th>Lien</th>
                                            <th>Taille</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Examens -->
                    <div id="examens" class="tab-content">
                        <div class="page-header">
                            <h2>Sujets d'Examen</h2>
                        </div>
                        <div class="glass content-card">
                            <h3>Ajouter un Sujet</h3>
                            <div class="grid">
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="examenAnnee">
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Titre</label>
                                    <input type="text" id="examenTitre" placeholder="Ex: EFM Java 2023">
                                </div>
                                <div class="form-group">
                                    <label>Fichier</label>
                                    <input type="file" id="examenFile">
                                </div>
                            </div>
                            <button class="btn" onclick="ajouterExamen()">Ajouter</button>
                        </div>
                        <div class="glass content-card">
                            <div class="table-responsive">
                                <table id="examensList">
                                    <thead>
                                        <tr>
                                            <th>Titre</th>
                                            <th>Ann√©e</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" style="text-align:center">Chargement...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Dates d'examen -->
                    <div id="dates-examens" class="tab-content">
                        <div class="page-header">
                            <h2>Dates d'examen</h2>
                        </div>
                        <div class="glass content-card">
                            <h3>Ajouter une date d'examen</h3>
                            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                                <div class="form-group">
                                    <label>Titre</label>
                                    <input type="text" id="examenDateTitre" placeholder="Ex: EFM Java">
                                </div>
                                <div class="form-group">
                                    <label>Ann√©e</label>
                                    <select id="examenDateAnnee">
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Date</label>
                                    <input type="date" id="examenDateDate">
                                </div>
                                <div class="form-group">
                                    <label>Heure D√©but</label>
                                    <input type="time" id="examenDateHeureDebut">
                                </div>
                                <div class="form-group">
                                    <label>Heure Fin</label>
                                    <input type="time" id="examenDateHeureFin">
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn" onclick="ajouterExamenDate()"><i class="fas fa-plus"></i>
                                        Ajouter</button>
                                </div>
                            </div>
                        </div>

                        <div class="glass content-card">
                            <h3>Calendrier Actuel</h3>
                            <div class="timeline" id="calendrierList">
                                <div style="text-align: center; color: var(--text-secondary);">
                                    <p>Chargement du calendrier...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vacances -->
                    <div id="vacances" class="tab-content">
                        <div class="page-header">
                            <h2>Vacances</h2>
                        </div>
                        <div class="glass content-card">
                            <ul id="vacancesList">
                                <li>Chargement...</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Statistiques -->
                    <div id="statistiques" class="tab-content">
                        <div class="page-header">
                            <h2>Statistiques de Connexion</h2>
                        </div>
                        <div class="glass content-card">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3>Activit√© des Stagiaires</h3>
                                <div class="form-group" style="margin: 0; width: 200px;">
                                    <select id="filterStatsAnnee" onchange="afficherStatistiques()">
                                        <option value="">Toutes les ann√©es</option>
                                        <option value="1A">1√®re Ann√©e (1A)</option>
                                        <option value="2A">2√®me Ann√©e (2A)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table id="statistiquesTable">
                                    <thead>
                                        <tr>
                                            <th>CIN</th>
                                            <th>Nom</th>
                                            <th>Pr√©nom</th>
                                            <th>Ann√©e</th>
                                            <th>Connexions</th>
                                            <th>Derni√®re connexion</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6">Chargement...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Param√®tres -->
                    <div id="parametres" class="tab-content">
                        <div class="page-header">
                            <h2>Param√®tres</h2>
                        </div>
                        <div class="glass content-card" style="max-width: 600px; margin: 0 auto;">
                            <h3>Mon Profil</h3>
                            <div class="form-group">
                                <label>Nom complet</label>
                                <input type="text" id="paramsNom" readonly style="opacity: 0.7; cursor: not-allowed;">
                            </div>

                            <h3 style="margin-top: 30px;">S√©curit√©</h3>
                            <div class="form-group">
                                <label>Nouveau mot de passe</label>
                                <input type="password" id="newPassword" placeholder="Laisser vide pour ne pas changer">
                            </div>
                            <div class="password-wrapper" style="margin-top: 10px;">
                                <input type="password" id="confirmNewPassword"
                                    placeholder="Confirmer le nouveau mot de passe">
                            </div>
                        </div>

                        <h3 style="margin-top: 30px;">Pr√©f√©rences</h3>
                        <div class="form-group"
                            style="display: flex; align-items: center; justify-content: space-between;">
                            <label style="margin: 0;">Mode Sombre (D√©faut)</label>
                            <input type="checkbox" id="darkMode" checked disabled style="width: auto;">
                        </div>

                        <!-- Administration Stagiaires (Visible uniquement pour Formateur via JS) -->
                        <div id="adminStagiairesSection"
                            style="display: none; margin-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
                            <h3>Administration Stagiaires</h3>
                            <div class="form-group">
                                <label>S√©lectionner un stagiaire</label>
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <select id="filterAdminAnnee" style="width: 30%;"
                                        onchange="filterStagiairesAdmin()">
                                        <option value="">Ann√©e</option>
                                        <option value="1A">1A</option>
                                        <option value="2A">2A</option>
                                    </select>
                                    <select id="selectStagiaireAdmin" style="flex-grow: 1;">
                                        <option value="">-- Choisir un stagiaire --</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Nouveau mot de passe</label>
                                <div class="password-wrapper">
                                    <input type="password" id="newStagiairePassword" placeholder="Nouveau mot de passe">
                                </div>
                                <div class="password-wrapper" style="margin-top: 10px;">
                                    <input type="password" id="confirmStagiairePassword"
                                        placeholder="Confirmer le mot de passe">
                                </div>
                            </div>
                            <button class="btn btn-secondary" onclick="changeStagiairePassword()" style="width: 100%;">
                                <i class="fas fa-key"></i> Changer le mot de passe du stagiaire
                            </button>
                        </div>

                        <button class="btn" onclick="saveSettings()" style="margin-top: 20px; width: 100%;">
                            <i class="fas fa-save"></i> Enregistrer mes pr√©f√©rences
                        </button>
                    </div>
            </div>

            </main>
        </div>
    </div>

    <!-- Dashboard Stagiaire -->
    <div id="stagiaireDashboard" class="dashboard glass">
        <div class="dashboard-layout">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2></h2>
                </div>
                <div class="user-info">
                    <div class="user-avatar"><i class="fas fa-user-graduate"></i></div>
                    <div class="user-details">
                        <h3 id="stagiaireName">Stagiaire</h3>
                        <p id="stagiaireCIN">CIN</p>
                    </div>
                </div>
                <nav class="nav-links">
                    <button class="nav-item active" onclick="switchTab('mes-notes')">
                        <i class="fas fa-star"></i> <span>Mes Notes</span>
                    </button>
                    <button class="nav-item" onclick="switchTab('mes-cours')">
                        <i class="fas fa-book-open"></i> <span>Mes Cours</span>
                    </button>
                    <button class="nav-item" onclick="switchTab('mes-absences')">
                        <i class="fas fa-history"></i> <span>Mes Absences</span>
                    </button>
                    <button class="nav-item" onclick="switchTab('calendrier-stagiaire')">
                        <i class="fas fa-calendar-alt"></i> <span>Dates des examens</span>
                    </button>
                    <button class="nav-item" onclick="switchTab('sujets-stagiaire')">
                        <i class="fas fa-file-alt"></i> <span>Sujets des examens</span>
                    </button>
                    <button class="nav-item" onclick="switchTab('parametres-stagiaire')">
                        <i class="fas fa-cog"></i> <span>Param√®tres</span>
                    </button>
                    <button class="nav-item" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> <span>D√©connexion</span>
                    </button>
                </nav>
            </aside>

            <main class="main-content">
                <div id="mes-notes" class="tab-content active">
                    <div class="page-header">
                        <h2>Mes R√©sultats</h2>
                    </div>
                    <div class="glass content-card">
                        <div class="table-responsive">
                            <table id="mesNotesTable">
                                <thead>
                                    <tr>
                                        <th>Module</th>
                                        <th>Type</th>
                                        <th>Coef.</th>
                                        <th>Contr√¥les</th>
                                        <th>EFM</th>
                                        <th>Moyenne</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Other Stagiaire Tabs -->
                <div id="mes-cours" class="tab-content">
                    <div class="page-header">
                        <h2>Mes Cours</h2>
                    </div>
                    <div class="glass content-card">
                        <table id="mesCoursList">
                            <thead>
                                <tr>
                                    <th>Titre</th>
                                    <th>Module</th>
                                    <th>Lien</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div id="mes-absences" class="tab-content">
                    <div class="page-header">
                        <h2>Mes Absences</h2>
                    </div>
                    <div class="glass content-card">
                        <div class="table-responsive">
                            <table id="mesAbsencesTable">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Horaire</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="3">Aucune absence enregistr√©e.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Calendrier Stagiaire -->
                <div id="calendrier-stagiaire" class="tab-content">
                    <div class="page-header">
                        <h2>Calendrier des Examens</h2>
                    </div>
                    <div class="glass content-card">
                        <div class="timeline" id="calendrierListStagiaire">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Sujets Stagiaire -->
                <div id="sujets-stagiaire" class="tab-content">
                    <div class="page-header">
                        <h2>Sujets d'Examen</h2>
                    </div>
                    <div class="glass content-card">
                        <table class="data-table" id="examensListStagiaire">
                            <thead>
                                <tr>
                                    <th>Titre</th>
                                    <!-- Module and Annee removed for Stagiaire -->
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Param√®tres Stagiaire -->
                <div id="parametres-stagiaire" class="tab-content">
                    <div class="page-header">
                        <h2>Param√®tres</h2>
                    </div>
                    <div class="glass content-card">
                        <h3>Mon Profil</h3>
                        <div class="form-group">
                            <label>Nom complet</label>
                            <input type="text" id="paramsNomStagiaire" readonly
                                style="opacity: 0.7; cursor: not-allowed;">
                        </div>

                        <h3 style="margin-top: 30px;">S√©curit√©</h3>
                        <div class="form-group">
                            <label>Nouveau mot de passe</label>
                            <div class="password-wrapper">
                                <input type="password" id="newPasswordStagiaire"
                                    placeholder="Laisser vide pour ne pas changer">
                            </div>
                            <div class="password-wrapper" style="margin-top: 10px;">
                                <input type="password" id="confirmNewPasswordStagiaire"
                                    placeholder="Confirmer le nouveau mot de passe">
                            </div>
                        </div>

                        <h3 style="margin-top: 30px;">Pr√©f√©rences</h3>
                        <div class="form-group"
                            style="display: flex; align-items: center; justify-content: space-between;">
                            <label style="margin: 0;">Mode Sombre</label>
                            <input type="checkbox" id="darkModeStagiaire" checked style="width: auto;">
                        </div>

                        <button class="btn" onclick="saveSettingsStagiaire()" style="margin-top: 20px; width: 100%;">
                            <i class="fas fa-save"></i> Enregistrer mes pr√©f√©rences
                        </button>
                    </div>
                </div>

            </main>
        </div>
    </div>

    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="assets/js/app_bundled.js"></script>
    <script>
        // Init logic for modules select population
        // Since loadData is async, we might need a way to populate selects after data load
        // We will add a listener or call it from app.js logic

        // Simple auto-run init if needed
        document.addEventListener('DOMContentLoaded', () => {
            // Optional: Check if session exists (simplified in app.js via currentUser variables)
        });
    </script>
</body>

</html>